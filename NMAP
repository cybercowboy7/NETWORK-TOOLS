NMAP: Network Mapper

- Basic Scan: nmap <ip address>
  - Scans the first 1000 most common ports by default
  - Default is to scan TCP ports and not UDP
  - State heading has multiple options
    - filtered: Firewall allowing access to the ports from specific ip
    - Open: Is open
    - Closed: Is closed 

- More advanced scan: nmap -sV -sC -p- <ip address>
  - sC: specifies that nmap scripts should be used to try and optain more detailed information
  - sV: perform a version scan
  - -p-: Scan all 65535 TCP ports

- Nmap Scripts:
  - locate scripts/<scripts string>

- Banner Grabbing: nmap -sV --script=banner <ip address>
- nmap -sV --script=banner -p21 10.10.10.0/24


nmap -sV --open -oA nibbles_initial_scan <ip address>
- sV: Service enumeration for default top 1000 ports
--open: Only returns open ports
-v: Verbose output
-oA: Output all scan formats

nmap -sC -p 22,80 -oA nibbles_script_scan <ip address>
-sC: script scan utilizing the default scripts https://nmap.org/nsedoc/categories/default.html


nmap -sV --script=http-enum -oA nibbles_nmap_http_enum <ip address>


nmap -sS localhost
- sS: SYN scan. Sends only SYN packet 


HOST DISCOVERY:

nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5
-sn: Disables port scanning
-oA tnet: Stores results in all formats starting with the name "tnet"

sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5
-sn: Disbales port scanning
-oA tnet: Stores results in all formats starting with the name "tnet"
-iL: Performs defined scans against targets in provided 'hosts.lst' list

sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut -d" " -f5
- Scan a smaller part of the network

sudo nmap -sn -oA tnet 10.129.2.18-20| grep for | cut -d" " -f5
- Same as above

sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace 
-PE: Performs the ping scan by using "ICMP echo requests" against the target
--packet-trace: Shows all packets sent and received

 sudo nmap 10.129.2.18 -sn -oA host -PE --reason 
--reason: Displays the reason for specific result

sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace --disable-arp-ping 
--disable-arp-ping: 

IDENTIFYING SYSTEMS BASED OFF TTL

- Windows == 128
- Linux == 255
- MAC/Linux == 68


HOST AND PORT SCANNING:

- Different Port states:
open	                  This indicates that the connection to the scanned port has been established. These connections can be TCP connections, UDP datagrams as well as SCTP associations.
closed	                When the port is shown as closed, the TCP protocol indicates that the packet we received back contains an RST flag. This scanning method can also be used to determine if our target is alive or not.
filtered	              Nmap cannot correctly identify whether the scanned port is open or closed because either no response is returned from the target for the port or we get an error code from the target.
unfiltered	            This state of a port only occurs during the TCP-ACK scan and means that the port is accessible, but it cannot be determined whether it is open or closed.
open|filtered	          If we do not get a response for a specific port, Nmap will set it to that state. This indicates that a firewall or packet filter may protect the port.
closed|filtered	        This state only occurs in the IP ID idle scans and indicates that it was impossible to determine if the scanned port is closed or filtered by a firewall.

sudo nmap 10.129.2.28 --top-ports=10
- Scans top ten ports

sudo nmap 10.129.2.28 --top-ports=10 
-Pn: Disable the ICMP echo requests
-n: DNS resolution
--disable-arp-ping: disables arp ping

- Connect Scan
  -sT: utilizes 3-way handshake and is most accurate way of determining state of port
    - Not stealthy
sudo nmap 10.129.2.28 -p 443 --packet-trace --disable-arp-ping -Pn -n --reason -sT
-Pn: Disable the ICMP echo requests
-n: DNS resolution
-sT: TCP connect scan

sudo nmap 10.129.2.28 -p 139 --packet-trace -n --disable-arp-ping -Pn

sudo nmap 10.129.2.28 -F -sU
-F: Scans top 100 ports
-sU: Performs a UDP scan

sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 137 --reason 


sudo nmap 10.129.2.28 -Pn -n --disable-arp-ping --packet-trace -p 445 --reason  -sV



SAVING THE RESULTS:

Normal output       (-oN) with the .nmap file extension
Grepable output     (-oG) with the .gnmap file extension
XML output          (-oX) with the .xml file extension

sudo nmap 10.129.2.28 -p- -oA target

To convert XML format to HTML you can utilize: xsltproc target.xml -o target.html



SERVICE ENUMERATION:

sudo nmap <ip address> -p- -sV --stats-every=5s

--stats-every=5s : Defines the periods of time the status should be shown

OR

-v / -vv : Increases the verbosity of the output


10.129.2.49







































